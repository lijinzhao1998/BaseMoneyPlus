# 基金管理系统 - GUI 使用指南

## 🚀 快速开始

### 启动GUI

**方式1：双击运行（推荐）**
```
双击文件：run_gui.bat
```

**方式2：命令行运行**
```bash
py gui_manager.py
```

**方式3：Python运行**
```bash
python gui_manager.py
```

---

## 📊 界面布局

### 主界面说明

```
┌─────────────────────────────────────────────────────────┐
│              📊 基金管理系统 v2.2                        │
├──────────────┬──────────────────────────────────────────┤
│              │                                          │
│  功能菜单    │         持仓基金表格                     │
│              │  (代码|名称|成本|金额|购买日期|投入日期)  │
│  【配置管理】 │                                          │
│  ➕添加持仓   │─────────────────────────────────────────│
│  👀添加观察   │                                          │
│  ✏️更新信息   │         观察基金表格                     │
│  🗑️删除基金   │  (代码|名称|观察日期|备注)               │
│  🔄观察→持仓  │                                          │
│  🔄持仓→观察  │                                          │
│              │                                          │
│  【批量操作】 │                                          │
│  📦批量添加   │                                          │
│  🗑️批量删除   │                                          │
│              │                                          │
│  【均线分析】 │                                          │
│  📈运行分析   │                                          │
│  📊导出报告   │                                          │
│              │                                          │
│  【清除操作】 │                                          │
│  ⚠️清除持仓   │                                          │
│  ⚠️清除观察   │                                          │
│              │                                          │
│  🔄刷新数据   │                                          │
└──────────────┴──────────────────────────────────────────┘
```

---

## 🎯 功能详解

### 1. 配置管理

#### 1.1 ➕ 添加持仓基金

**步骤**：
1. 点击"添加持仓基金"按钮
2. 填写表单：
   - 基金代码（必填）：如 `161725`
   - 基金名称（必填）：如 `招商中证白酒`
   - 成本净值（必填）：如 `1.0`
   - 持有金额（必填）：如 `10000`
   - 购买日期（必填）：如 `2024-01-01`
   - 投入日期（可选）：如 `2024-01-01`
3. 点击"确定"

**注意**：
- 投入日期用于准确计算收益
- 如果不填，默认使用购买日期
- 所有日期格式：YYYY-MM-DD

**示例**：
```
基金代码: 161725
基金名称: 招商中证白酒
成本净值: 1.0
持有金额: 10000
购买日期: 2024-01-01
投入日期: 2024-01-01
```

#### 1.2 👀 添加观察基金

**步骤**：
1. 点击"添加观察基金"按钮
2. 填写表单：
   - 基金代码（必填）
   - 基金名称（必填）
   - 观察日期（可选）
   - 备注（可选）
3. 点击"确定"

**用途**：
- 跟踪感兴趣但未购买的基金
- 通过均线分析判断买入时机
- 记录观察理由和计划

**示例**：
```
基金代码: 161726
基金名称: 招商食品饮料
观察日期: 2024-01-10
备注: 等待回调至MA60附近
```

#### 1.3 ✏️ 更新基金信息

**功能**：修改已有基金的信息

**建议**：
- 目前建议直接编辑配置文件
- 或使用命令行工具 `config_manager.py`
- GUI下一版本将完善此功能

#### 1.4 🗑️ 删除基金

**步骤**：
1. 点击"删除基金"按钮
2. 输入基金代码
3. 选择删除范围：
   - 持仓
   - 观察
4. 确认删除

**安全提示**：
- 删除前会弹出确认对话框
- 配置会自动备份
- 删除后可从备份恢复

#### 1.5 🔄 观察→持仓

**场景**：观察的基金到了买入点，正式买入

**步骤**：
1. 点击"观察→持仓"按钮
2. 输入基金代码
3. 填写持仓信息：
   - 成本净值
   - 持有金额
   - 购买日期
4. 点击"确定"

**效果**：
- 基金从观察列表移除
- 添加到持仓列表
- 保留基金名称等基本信息

#### 1.6 🔄 持仓→观察

**场景**：卖出持仓基金，但想继续观察

**步骤**：
1. 点击"持仓→观察"按钮
2. 输入基金代码
3. 输入备注（可选）
4. 点击"确定"

**效果**：
- 基金从持仓列表移除
- 添加到观察列表
- 备注会记录原成本信息

---

### 2. 批量操作

#### 2.1 📦 批量添加持仓

**场景**：
- 首次导入大量持仓数据
- 从Excel整理好数据批量导入

**步骤**：
1. 点击"批量添加持仓"按钮
2. 在文本框中输入数据（每行一个基金）
3. 格式：`代码,名称,成本净值,金额,购买日期,投入日期`
4. 点击"确定"

**示例数据**：
```
161725,招商中证白酒,1.0,10000,2024-01-01,2024-01-01
161726,招商食品饮料,0.95,8000,2024-01-15,2024-01-15
161028,富国新能源汽车,1.2,5000,2024-02-01,2024-02-01
```

**技巧**：
- 在Excel中准备数据，复制粘贴
- 投入日期可以省略（自动使用购买日期）
- 格式错误的行会被跳过并提示

#### 2.2 📦 批量添加观察

**场景**：
- 批量添加自选基金
- 从研究报告中批量导入

**步骤**：
1. 点击"批量添加观察"按钮
2. 在文本框中输入数据
3. 格式：`代码,名称,观察日期,备注`
4. 点击"确定"

**示例数据**：
```
161727,招商医药健康,2024-01-20,等待回调
161728,招商中证消费,,关注趋势
110011,易方达中小盘,2024-02-01,长期跟踪
```

**简化格式**：
```
161727,招商医药健康
161728,招商中证消费
110011,易方达中小盘
```

**说明**：
- 观察日期和备注都可省略
- 最简只需：代码,名称

#### 2.3 🗑️ 批量删除基金

**场景**：
- 清理不再关注的基金
- 批量调整持仓

**步骤**：
1. 点击"批量删除基金"按钮
2. 输入基金代码（逗号分隔）
3. 选择删除范围：
   - 仅持仓
   - 仅观察
   - 持仓和观察都删
4. 确认删除

**示例**：
```
输入代码: 161725,161726,161727
删除范围: 仅观察
```

**提示**：
- 支持空格（会自动清除）
- 不存在的代码会提示

---

### 3. 均线分析

#### 3.1 📈 运行均线分析

**功能**：
- 分析所有持仓和观察基金
- 计算多周期均线
- 生成买卖建议
- 计算收益情况

**步骤**：
1. 点击"运行均线分析"按钮
2. 确认运行
3. 等待分析完成（后台运行）
4. 完成后弹出提示

**特点**：
- 后台运行，不阻塞界面
- 可以继续其他操作
- 自动使用配置文件数据
- 结果保存到内存

**时间**：
- 单个基金约 5-10 秒
- 10个基金约 1-2 分钟
- 根据网络速度有所不同

#### 3.2 📊 导出报告

**功能**：将分析结果导出为报告文件

**支持格式**：
- **HTML格式**（推荐）：精美网页，带图表
- **TXT格式**：纯文本，易打印
- **Markdown格式**：适合GitHub
- **JSON格式**：原始数据

**步骤**：
1. 先运行均线分析
2. 点击"导出报告"按钮
3. 选择格式
4. 确定

**提示**：
- 目前需要在命令行版本选择格式
- GUI版本会自动使用HTML格式
- 报告保存在 `reports` 目录

#### 3.3 📁 打开报告目录

**功能**：快速打开报告文件夹

**步骤**：
1. 点击"打开报告目录"按钮
2. 自动打开 `reports` 文件夹
3. 查看和管理报告文件

**目录结构**：
```
reports/
├── 均线分析报告_20241030_143022.html
├── 均线分析报告_20241030_143022.txt
├── 均线分析报告_20241030_143022.md
└── 均线分析报告_20241030_143022.json
```

---

### 4. 清除操作

#### 4.1 ⚠️ 清除所有持仓

**场景**：重新规划持仓，清空重来

**步骤**：
1. 点击"清除所有持仓"按钮
2. 查看即将删除的基金列表
3. 输入 `YES` 确认
4. 点击确定

**安全机制**：
- 显示详细列表供确认
- 需要明确输入 YES（大写）
- 自动备份配置文件
- 不影响观察列表

**恢复方法**：
```bash
# 从备份恢复
copy holdings_config.json.backup holdings_config.json
```

#### 4.2 ⚠️ 清除所有观察

**场景**：清理观察列表，重新筛选

**步骤**：
1. 点击"清除所有观察"按钮
2. 确认操作
3. 输入 YES

**特点**：
- 不影响持仓列表
- 独立清空观察数据
- 同样会备份

#### 4.3 ⚠️ 清除所有配置

**场景**：完全重置，从头开始

**警告**：这是最高级别的清除操作！

**步骤**：
1. 点击"清除所有配置"按钮
2. 阅读警告信息
3. 二次确认
4. 输入 YES

**影响**：
- 清空所有持仓基金
- 清空所有观察基金
- 保留配置文件结构
- 自动备份

**建议**：
- 操作前手动备份配置文件
- 确保真的需要清空
- 慎重使用

---

### 5. 其他功能

#### 5.1 🔄 刷新数据

**功能**：重新加载配置文件，刷新显示

**使用场景**：
- 修改了配置文件
- 其他程序更新了配置
- 显示数据不同步

**步骤**：
- 点击"刷新数据"按钮
- 自动重新加载
- 更新表格显示

---

## 💡 使用技巧

### 技巧1：快捷键

- **Tab键**：在对话框中切换输入框
- **Enter键**：提交表单（部分对话框）
- **Esc键**：关闭对话框（系统支持时）

### 技巧2：批量数据准备

**使用Excel准备数据**：

1. 在Excel中整理基金数据

| 代码 | 名称 | 成本净值 | 金额 | 购买日期 | 投入日期 |
|------|------|----------|------|----------|----------|
| 161725 | 招商白酒 | 1.0 | 10000 | 2024-01-01 | 2024-01-01 |
| 161726 | 招商食品 | 0.95 | 8000 | 2024-01-15 | 2024-01-15 |

2. 选中数据（不含表头）

3. 复制 (Ctrl+C)

4. 在GUI中，点击"批量添加持仓"

5. 粘贴 (Ctrl+V)

6. 确定

### 技巧3：数据备份策略

**自动备份**：
- 每次保存都会自动备份为 `.backup` 文件
- 位置：`holdings_config.json.backup`

**手动备份**：
```bash
# 定期手动备份
copy holdings_config.json holdings_config_20241030.json
```

**恢复备份**：
```bash
# 恢复自动备份
copy holdings_config.json.backup holdings_config.json

# 恢复手动备份
copy holdings_config_20241030.json holdings_config.json
```

### 技巧4：表格操作

**查看详细信息**：
- 鼠标悬停在表格行上
- 可以看到完整的信息

**排序**：
- 点击表头可以排序（部分系统支持）
- 按代码、名称等字段排序

**复制数据**：
- 选中表格行
- 右键复制（部分系统支持）

### 技巧5：工作流建议

**每周工作流**：
```
1. 打开GUI
   ↓
2. 查看持仓表格
   ↓
3. 运行均线分析
   ↓
4. 查看HTML报告
   ↓
5. 根据建议调整持仓
   ↓
6. 更新配置
```

**月度工作流**：
```
1. 导出报告（保留记录）
   ↓
2. 清理观察列表
   ↓
3. 添加新的观察基金
   ↓
4. 批量更新持仓信息
   ↓
5. 备份配置文件
```

---

## 🔧 高级功能

### 1. 配置文件直接编辑

虽然GUI提供了大部分功能，但有时直接编辑配置文件更快：

**位置**：`holdings_config.json`

**编辑器推荐**：
- VS Code
- Notepad++
- Sublime Text

**注意**：
- 编辑后在GUI中点击"刷新数据"
- 保持JSON格式正确
- 建议先备份

### 2. 与命令行工具配合

**GUI + 命令行工具的组合使用**：

- **GUI**：日常查看和简单操作
- **命令行**：批量操作和高级功能

**示例场景**：
```bash
# 使用GUI添加基金和查看
→ 打开 run_gui.bat

# 使用命令行运行分析（更多控制选项）
→ py ma_analysis.py

# 使用配置管理器高级功能
→ py config_manager.py
```

### 3. 自动化脚本

**创建自动化脚本**：

```batch
@echo off
REM 每日自动分析脚本

echo 正在运行均线分析...
py ma_analysis.py

echo 正在导出报告...
REM 这里可以添加导出逻辑

echo 完成！
pause
```

---

## ❓ 常见问题

### Q1: GUI启动失败？

**检查项**：
1. Python是否正确安装
2. tkinter是否可用（Python自带）
3. 依赖是否安装完整

**解决**：
```bash
# 测试tkinter
py -c "import tkinter"

# 如果报错，重新安装Python
# 安装时勾选 "tcl/tk and IDLE"
```

### Q2: 界面显示模糊（Windows）？

**原因**：高DPI缩放问题

**解决**：
1. 右键 python.exe
2. 属性 → 兼容性
3. 更改高DPI设置
4. 勾选"替代高DPI缩放行为"
5. 选择"系统(增强)"

### Q3: 分析运行很慢？

**可能原因**：
- 网络问题
- 基金数量过多
- 历史数据量大

**解决**：
- 检查网络连接
- 分批次分析
- 减少观察列表

### Q4: 数据不同步？

**原因**：配置文件被其他程序修改

**解决**：
- 点击"刷新数据"按钮
- 关闭其他可能修改配置的程序
- 重启GUI

### Q5: 无法导出报告？

**检查项**：
1. 是否先运行了分析
2. reports目录权限
3. 磁盘空间是否充足

**解决**：
```bash
# 手动创建reports目录
mkdir reports

# 检查权限
# 右键 reports → 属性 → 安全
```

### Q6: 清除操作后如何恢复？

**恢复步骤**：
```bash
# 方法1：从自动备份恢复
copy holdings_config.json.backup holdings_config.json

# 方法2：从手动备份恢复（如果有）
copy holdings_config_backup_20241030.json holdings_config.json
```

**在GUI中**：
1. 关闭GUI
2. 恢复备份文件
3. 重新打开GUI
4. 点击"刷新数据"

---

## 📱 多平台支持

### Windows

**完美支持**，所有功能正常

**启动**：
- 双击 `run_gui.bat`
- 或命令行: `py gui_manager.py`

### macOS

**支持**，界面可能略有差异

**启动**：
```bash
python3 gui_manager.py
```

**注意**：
- 部分快捷键不同
- 界面元素可能较小（Retina屏）

### Linux

**支持**，需要安装tk

**安装依赖**：
```bash
# Ubuntu/Debian
sudo apt-get install python3-tk

# Fedora
sudo dnf install python3-tkinter
```

**启动**：
```bash
python3 gui_manager.py
```

---

## 🎨 界面自定义

虽然GUI当前使用标准主题，但可以通过修改代码自定义：

**主题位置**：`gui_manager.py` → `setup_style()` 方法

**可自定义项**：
- 颜色方案
- 字体大小
- 按钮样式
- 窗口大小

**示例**：
```python
# 修改主题颜色
style.configure('Primary.TButton', 
                foreground='white', 
                background='#your_color')
```

---

## 📞 获取帮助

### 文档资源

- [README.md](README.md) - 项目总览
- [均线分析说明.md](均线分析说明.md) - 分析功能详解
- [快速使用指南.md](快速使用指南.md) - 快速入门
- [v2.2更新日志.md](v2.2更新日志.md) - 版本更新

### 遇到问题？

1. **查看文档**：大部分问题文档中都有答案
2. **检查配置**：确保配置文件格式正确
3. **查看日志**：GUI错误会弹出详细提示
4. **重启程序**：有时简单重启就能解决

---

## 🎯 最佳实践

### 1. 数据管理

- ✅ 定期备份配置文件
- ✅ 保持观察列表精简
- ✅ 及时更新持仓信息
- ❌ 不要同时运行多个GUI

### 2. 分析习惯

- ✅ 每周运行一次分析
- ✅ 保存历史报告用于对比
- ✅ 结合基本面分析
- ❌ 不要仅依赖技术指标

### 3. 操作规范

- ✅ 重要操作前先备份
- ✅ 使用批量功能提高效率
- ✅ 善用观察列表筛选目标
- ❌ 不要频繁清空配置

---

## 🎊 总结

GUI图形化界面让基金管理变得更加简单直观：

**核心优势**：
- 📊 可视化数据展示
- 🚀 一键式操作
- 🎯 集成所有功能
- 💡 友好的用户界面

**适合人群**：
- 新手用户
- 偏好图形界面
- 需要批量操作
- 日常管理投资

**开始使用**：
```bash
# 立即启动
run_gui.bat
```

**祝您投资顺利！📈**

