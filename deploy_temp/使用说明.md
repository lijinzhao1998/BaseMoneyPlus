# 基金管家系统 - 使用说明

## 🎯 问题解决

### 问题1：脚本运行后没有任何输出
**原因：** Windows上默认的`python`命令指向Windows Store的存根程序  
**解决方案：** 使用 `py` 命令而不是 `python` 命令

### 问题2：基金分析失败
**原因：** API返回格式从JSONP改为纯JSON，但代码只支持JSONP格式  
**解决方案：** 已修复 `fund_data.py`，现在同时支持纯JSON和JSONP两种格式

### 已修复的问题
✅ 修复了 `fund_analyzer.py` 的缩进错误（第113行）  
✅ 修复了历史数据获取失败的bug（API格式兼容性问题）  
✅ 所有基金现在都能正常分析

## 🚀 快速开始

### 1. 测试系统

```bash
py test.py
```

选择测试选项：
- 1: 测试数据获取
- 2: 测试分析器
- 3: 测试消息发送
- 4: 全部测试

### 2. 运行主程序

```bash
py main.py
```

或者直接双击 `run.bat`

选择运行模式：
- 1: 立即运行一次（生成并发送报告）
- 2: 启动定时任务（后台运行）
- 3: 退出

### 3. 配置

#### 修改持仓信息
编辑 `main.py` 中的 `holdings` 字典：

```python
self.holdings = {
    "017811": {"cost_basis": 1.0, "amount": 10000},  # 修改成本和金额
    # ... 其他基金
}
```

#### 配置消息推送（可选）

创建 `.env` 文件：

```env
# 服务器酱（微信推送）
SERVER_CHAN_KEY=your_key

# 企业微信
WECHAT_WEBHOOK=your_webhook

# 钉钉
DINGTALK_WEBHOOK=your_webhook
```

## 📝 注意事项

1. **如果没有配置推送服务**，报告仍然会生成并显示在控制台
2. **修改持仓信息**：根据你的实际持仓修改成本和金额
3. **API请求限制**：已添加延时，避免请求过快
4. **数据来源**：从公开API获取基金净值数据

## 🔧 依赖检查

所有依赖已安装完成：
- ✓ requests
- ✓ pandas
- ✓ numpy
- ✓ scikit-learn
- ✓ beautifulsoup4
- ✓ matplotlib
- ✓ schedule

## 📊 报告示例

```
📊 基金管家日报 - 2025-10-27 08:52:58
==================================================

【XXXX基金 017811】📈
  今日涨跌: +4.25%
  今日收益: +425.00元
  累计收益: +5159.00元 (+51.59%)
  当前净值: 1.5159
  趋势: 震荡整理
  预测趋势: -8.03% (未来5天平均)

【XXXX基金 002963】📉
  今日涨跌: -0.49%
  今日收益: -49.00元
  累计收益: +9974.67元 (+99.75%)
  当前净值: 2.9962
  趋势: 震荡整理
  预测趋势: +2.60% (未来5天平均)

==================================================
📊 总资产收益: +47006.17元
📈 今日总收益: +1752.00元
==================================================

⚠️ 风险提示：投资有风险，入市需谨慎
```

## ❓ 常见问题

**Q: 为什么使用 `py` 而不是 `python`？**
A: Windows上`python`命令可能指向Windows Store的存根，使用`py`启动器更可靠。

**Q: 需要配置推送才能运行吗？**
A: 不需要。推送是可选的，报告会在控制台显示。

**Q: 如何修改定时时间？**
A: 编辑 `config.py` 中的 `SCHEDULE_TIME` 变量。

**Q: 数据是实时的吗？**
A: 基金净值通常在交易日18:00后更新。

## 📞 技术支持

如有问题，请检查：
1. Python版本（推荐 3.8+）
2. 依赖是否已安装
3. 网络连接是否正常
4. 基金代码是否正确
